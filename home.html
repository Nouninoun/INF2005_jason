<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Liste de contacts</title>

  </head>
  <body>
    <header>
      <!--<img = src='smiley.png'>-->
    </header>

    <section>

    </section>

    <script>
        //On charge les éléments du html
        var header = document.querySelector('header');
        var section = document.querySelector('section');

        //on charge l'URL du fichier .json
        var requestURL = 'https://github.com/Nouninoun/INF2005_jason/blob/master/struct.json';

        //On instancie l'objet XMLHttpRequest afin de pouvoir faire une requête
        var request = new XMLHttpRequest();

        //On ouvre une nouvelle requête
        request.open('GET', requestURL);

        request.responseType = 'json';
        request.send();

        request.onload = function() {
          var contacts = request.response;
          populateHeader(contacts);
          showContacts(contacts);
        }

        function populateHeader(jsonObj) {
          var myH1 = document.createElement('h1');
          myH1.textContent = jsonObj['datas'];
          header.appendChild(myH1);
        }

        function showContacts(jsonObj){
          var contacts = jsonObj['contacts'];

          for (var i = 0; i < contacts.length; i++)
          {
            var myArticle = document.createElement('article');
            var name = document.createElement('h2');
            var list = document.createElement('ul');
            var name1 = contacts[i].firstname;
            var name2 = contacts[i].lastname;
            //name.textContent = name1 + " " + name2;
            name.textContent = name1;

            var phonenumbers = contacts[i].phonenumbers;
            for (var y = 0; y<phonenumbers.length; y++)
            {
              var shownumber = document.createElement('li');
              var type = phonenumbers[y].type;
              var number = phonenumbers[y].number;
              shownumber.textContent = type + " : " + number;
              list.appendChild(shownumber);
            }
            myArticle.appendChild(name);
            myArticle.appendChild(list);
            section.appendChild(myArticle);
          }
        }

    </script>
  </body>
</html>
